<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Proxy: my_proxy.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Proxy
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('my__proxy_8py_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">my_proxy.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="my__proxy_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html">    1</a></span>&#160;<span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, abort, Response</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">from</span> flask <span class="keyword">import</span> render_template</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">import</span> connect_docker_server <span class="keyword">as</span> make_connection</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">import</span> config_parser <span class="keyword">as</span> parser</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">from</span> sqlalchemy.sql <span class="keyword">import</span> exists</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">import</span> random</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">import</span> string</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">import</span> json</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">from</span> functools <span class="keyword">import</span> wraps</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">import</span> validate_hostname <span class="keyword">as</span> validatehostname</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">from</span> werkzeug.security <span class="keyword">import</span> generate_password_hash</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> text</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a1316b64a06ccf8940bd886efa8d18660">   18</a></span>&#160;app = Flask(__name__)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"># TODO move to models.py</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keywordflow">try</span>:</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    app.config[<span class="stringliteral">&#39;SQLALCHEMY_DATABASE_URI&#39;</span>] = parser.config_params(<span class="stringliteral">&#39;dbname&#39;</span>)[<span class="stringliteral">&#39;location_name_db&#39;</span>]</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keywordflow">except</span> ImportError:</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">print</span> <span class="stringliteral">&#39;no db connection availabe&#39;</span></div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a3cda0544280d27f01985434ab3efa4b3">   25</a></span>&#160;db = SQLAlchemy(app)</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">   28</a></span>&#160;<span class="keyword">class </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(Exception):</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="stringliteral">    class to return specific return codes</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa06f3c7722ee51c93e799a0e57f67a32">   32</a></span>&#160;    status_code = 400</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa785dfd5e9946eb87e2a94d4544bc656">   34</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa785dfd5e9946eb87e2a94d4544bc656">__init__</a>(self, message, status_code=None, payload=None):</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        Exception.__init__(self)</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa61d504376bb9479db82cb7d97c70011">   36</a></span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa61d504376bb9479db82cb7d97c70011">message</a> = message</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">if</span> status_code <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#a6503499a33bc2de008fb69c03f453eec">   38</a></span>&#160;            self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa06f3c7722ee51c93e799a0e57f67a32">status_code</a> = status_code</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#a658b9343c56fde3e1753fe8ad1e1a158">   39</a></span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#a658b9343c56fde3e1753fe8ad1e1a158">payload</a> = payload</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#a50b7849f7141fc1455ace3691a9417a7">   41</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#a50b7849f7141fc1455ace3691a9417a7">to_dict</a>(self):</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        rv = dict(self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#a658b9343c56fde3e1753fe8ad1e1a158">payload</a> <span class="keywordflow">or</span> ())</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        rv[<span class="stringliteral">&#39;message&#39;</span>] = self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa61d504376bb9479db82cb7d97c70011">message</a></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">return</span> rv</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;@app.errorhandler(InvalidUsage)</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a0c927506d8346f17b620ac8e131174d0">   48</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a0c927506d8346f17b620ac8e131174d0">handle_invalid_usage</a>(error):</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    response = jsonify(error.to_dict())</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    response.status_code = error.status_code</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span> response</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a219b29b5c79ad35297fb1f1deef275a3">   54</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a219b29b5c79ad35297fb1f1deef275a3">require_appkey</a>(view_function):</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="stringliteral">    simple appkey validation</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="stringliteral">    it will check presence of the header secretkey with value 123</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="stringliteral">    :param view_function:</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    @wraps(view_function)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">def </span>decorated_function(*args, **kwargs):</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> request.headers.get(<span class="stringliteral">&#39;secretkey&#39;</span>) <span class="keywordflow">and</span> request.headers.get(<span class="stringliteral">&#39;secretkey&#39;</span>) == parser.config_params(<span class="stringliteral">&#39;proxy&#39;</span>)[</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="stringliteral">&#39;secretkey&#39;</span>]:</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">return</span> view_function(*args, **kwargs)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            abort(401)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">return</span> decorated_function</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html">   73</a></span>&#160;<span class="keyword">class </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html">MountPoints</a>(db.Model):</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="stringliteral">    let&#39;s create the mount points table</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    __tablename__ = <span class="stringliteral">&#39;mount&#39;</span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#a17378df4d222e5d86f97d966e5ba30ee">   78</a></span>&#160;    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>, autoincrement=<span class="keyword">True</span>)</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aa49cde7530c0edaec96a4407707e714d">   79</a></span>&#160;    owner = db.Column(db.String(80), unique=<span class="keyword">True</span>)</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aa7cfbe6eb066a60a4b6a0399fc64e003">   80</a></span>&#160;    mount_point = db.Column(db.String(200))</div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aec1c878c659bd308f99b529d397d85c7">   81</a></span>&#160;    volume_name = db.Column(db.String(200))</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#a6008b3f58ac2dd027f1d637cc84ee78c">   82</a></span>&#160;    size_plan = db.Column(db.String(80))</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#a559b6a122b5406dda695f40dc5eda8e9">   84</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#a559b6a122b5406dda695f40dc5eda8e9">__init__</a>(self, owner, mount_point, volume_name, size_plan):</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aa49cde7530c0edaec96a4407707e714d">owner</a> = owner</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aa7cfbe6eb066a60a4b6a0399fc64e003">mount_point</a> = mount_point</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aec1c878c659bd308f99b529d397d85c7">volume_name</a> = volume_name</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#a6008b3f58ac2dd027f1d637cc84ee78c">size_plan</a> = size_plan</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aea56d9596b2864b4d089b0f34744f3f4">   90</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aea56d9596b2864b4d089b0f34744f3f4">__repr__</a>(self):</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral">        return only the mount point</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">return</span> str(self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aa7cfbe6eb066a60a4b6a0399fc64e003">mount_point</a>)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html">   96</a></span>&#160;<span class="keyword">class </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html">ContainerNames</a>(db.Model):</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">    let&#39;s do ContainerNames tables</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    __tablename__ = <span class="stringliteral">&#39;containers&#39;</span></div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a7013f7adde5d40aedd4169afb3be1978">  101</a></span>&#160;    id = db.Column(db.Integer, primary_key=<span class="keyword">True</span>, autoincrement=<span class="keyword">True</span>)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment"># random geerated name</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5223d4e116bb162d327af3fbdf406c62">  103</a></span>&#160;    name_of_container = db.Column(db.String(80), unique=<span class="keyword">True</span>)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment"># hostname</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#aacca73fd2984a6225ff6f82fb681a508">  105</a></span>&#160;    hostname = db.Column(db.String(80))</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment"># owner will be used also for login</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a18b80021fc434e7dac00f009f7a451b5">  107</a></span>&#160;    owner = db.Column(db.String(100))</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment"># password</span></div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5728904cb244540aa3421e07dc14cc84">  109</a></span>&#160;    password = db.Column(db.String(200))</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment"># public port for container</span></div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#accfbd6e258c7ede9ac75360c54086e2a">  111</a></span>&#160;    public_port = db.Column(db.Integer, unique=<span class="keyword">True</span>)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment"># service name</span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#ac067fae0674728a7064586300ef6b107">  113</a></span>&#160;    service_name = db.Column(db.String(100))</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a6f793b87c5c96d4c3c8becfbc748ada9">  115</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a6f793b87c5c96d4c3c8becfbc748ada9">__init__</a>(self, name_of_container, hostname, owner, password, public_port, service_name):</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5223d4e116bb162d327af3fbdf406c62">name_of_container</a> = name_of_container</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#aacca73fd2984a6225ff6f82fb681a508">hostname</a> = hostname</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a18b80021fc434e7dac00f009f7a451b5">owner</a> = owner</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5728904cb244540aa3421e07dc14cc84">password</a> = password</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">assert</span> isinstance(public_port, object)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#accfbd6e258c7ede9ac75360c54086e2a">public_port</a> = public_port</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#ac067fae0674728a7064586300ef6b107">service_name</a> = service_name</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5bade0263a94bbfc7ffba0b4179ae27e">  124</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5bade0263a94bbfc7ffba0b4179ae27e">__repr__</a>(self):</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="stringliteral">        return json</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">return</span> json.dumps(</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            {<span class="stringliteral">&#39;name_of_container&#39;</span>: self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5223d4e116bb162d327af3fbdf406c62">name_of_container</a>, <span class="stringliteral">&#39;hostname&#39;</span>: self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#aacca73fd2984a6225ff6f82fb681a508">hostname</a>,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;             <span class="stringliteral">&#39;owner&#39;</span>: self.name_of_user, <span class="stringliteral">&#39;password&#39;</span>: self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5728904cb244540aa3421e07dc14cc84">password</a>, <span class="stringliteral">&#39;public_port&#39;</span>: self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#accfbd6e258c7ede9ac75360c54086e2a">public_port</a>,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;             <span class="stringliteral">&#39;service_name&#39;</span>: self.<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#ac067fae0674728a7064586300ef6b107">service_name</a>})</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a0bf8985afda99ee825115bd5df0b6b40">  134</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a0bf8985afda99ee825115bd5df0b6b40">give_me_something_unique</a>(name_of_container, hostname, owner, password, service_name):</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral">    let&#39;s generate random and unique port</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral">    :rtype : object</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment"># generate random port</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    new_port = random.randrange(1025, 65000, 2)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">#my_random = &#39;&#39;.join(random.choice(string.ascii_uppercase + string.digits) for _ in range(6))</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> db.session.query(exists().where(ContainerNames.public_port == new_port)).scalar():</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        app.logger.info(<span class="stringliteral">&#39;there is a port assigned already, try to make a new one&#39;</span>)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            new_port = random.randrange(1025, 65000, 2)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            app.logger.info(<span class="stringliteral">&#39;try to insert, if working we god, if not we try again in excepetion&#39;</span>)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            db.session.add(</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html">ContainerNames</a>(name_of_container, hostname, owner, generate_password_hash(password),</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                               new_port, service_name))</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            db.session.commit()</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">except</span>:</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            app.logger.info(<span class="stringliteral">&#39;again we failed, we try again&#39;</span>)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            new_port = random.randrange(1025, 65000, 2)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            db.session.add(</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html">ContainerNames</a>(name_of_container, hostname, owner, generate_password_hash(password),</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                               new_port, service_name))</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            db.session.commit()</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">print</span> <span class="stringliteral">&#39;port doesn\&#39;t exists, good to go&#39;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        db.session.add(</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_container_names.html">ContainerNames</a>(name_of_container, hostname, owner, generate_password_hash(password),</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                           new_port, service_name))</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        db.session.commit()</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span> new_port</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a32ea0c997fb4530822b84a6861f9666c">  167</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a32ea0c997fb4530822b84a6861f9666c">give_me_mount_point</a>(owner, size_plan):</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="stringliteral">    this function will generate a shared tmpfs volume, the size should always be in M</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="stringliteral">    let&#39;s insert mount points into table, user is unique, every user will have unique mount points</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> db.session.query(exists().where(MountPoints.owner == owner)).scalar():</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">#if user exists we will reuse the same volume</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        new_volume = MountPoints.query.filter_by(owner=owner).first()</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        new_volume_str = str(new_volume)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        app.logger.info(<span class="stringliteral">&#39;This user has already a volume assigend {0}&#39;</span>.format(new_volume_str[21:]))</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span> new_volume_str[21:]</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment"># seems this is a new user and we will create a new mount point for him</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        my_random = <span class="stringliteral">&#39;&#39;</span>.join(random.choice(string.ascii_uppercase + string.digits) <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(6))</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        size = <span class="stringliteral">&#39;size=&#39;</span> + size_plan</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment"># this will create a new volume</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        new_volume = make_connection.connect_docker_server().create_volume(name=owner + my_random, driver=<span class="stringliteral">&#39;local&#39;</span>,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                                                           driver_opts={<span class="stringliteral">&#39;type&#39;</span>: <span class="stringliteral">&#39;tmpfs&#39;</span>,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                                                                        <span class="stringliteral">&#39;device&#39;</span>: <span class="stringliteral">&#39;tmpfs&#39;</span>,</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                                                                        <span class="stringliteral">&#39;o&#39;</span>: size})</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        new_volume_created = new_volume[<span class="stringliteral">&#39;Mountpoint&#39;</span>][:-6]</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        new_volume_name = new_volume[<span class="stringliteral">&#39;Name&#39;</span>]</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        app.logger.info(<span class="stringliteral">&#39;new volume created:{0} for user:{1} with name {2}&#39;</span>.format(new_volume_created, owner, new_volume_name))</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        db.session.add(<a class="code" href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html">MountPoints</a>(owner, new_volume_created, new_volume_name, size_plan))</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        db.session.commit()</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">return</span> str(new_volume[<span class="stringliteral">&#39;Name&#39;</span>])</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a7c16c9ad1dd493bd800fb0ccb04cfe32">  195</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a7c16c9ad1dd493bd800fb0ccb04cfe32">docker_create</a>(name_id, username, password, service, diskspace, image_name, internal_port, exec_this):</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="stringliteral">    this function will create the container</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="stringliteral">    :rtype : object</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">#check if there is a container with the same name, anyway useless because docker is doing same thing</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">#we can remove this in the future</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> db.session.query(exists().where(ContainerNames.name_of_container == name_id)).scalar():</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">raise</span> <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(<span class="stringliteral">&#39;there is a vm already with this name&#39;</span>, status_code=404)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">#to the magic, generate unique port, make the shared volume</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    my_unique_port = <a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a0bf8985afda99ee825115bd5df0b6b40">give_me_something_unique</a>(name_id, name_id, username, password, service)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    my_new_volume = <a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a32ea0c997fb4530822b84a6861f9666c">give_me_mount_point</a>(username, diskspace)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        app.logger.info(<span class="stringliteral">&#39;Generating and inserting in db a new allocated port {0}&#39;</span>.format(my_unique_port))</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        where_to_mount = my_new_volume + parser.config_params(<span class="stringliteral">&#39;mount&#39;</span>)[<span class="stringliteral">&#39;where_to_mount_dir&#39;</span>]</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        app.logger.info(<span class="stringliteral">&#39;We will mount in this location {0}&#39;</span>.format(where_to_mount))</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        response = make_connection.connect_docker_server().create_container(image=image_name, hostname=name_id,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                                                            ports=[(my_unique_port, <span class="stringliteral">&#39;tcp&#39;</span>)],</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                                            host_config=make_connection.connect_docker_server().create_host_config(</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                                                                binds=[where_to_mount],</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                                                                port_bindings={</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                                                                    internal_port: my_unique_port},</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                                                                mem_limit=parser.config_params(<span class="stringliteral">&#39;container_settings&#39;</span>)[<span class="stringliteral">&#39;memory&#39;</span>]),</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                                                            command=exec_this, name=name_id)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        make_connection.connect_docker_server().start(container=response.get(<span class="stringliteral">&#39;Id&#39;</span>))</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        result_new_container = make_connection.connect.inspect_container(response.get(<span class="stringliteral">&#39;Id&#39;</span>))</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        new_hostname = result_new_container[<span class="stringliteral">&#39;Config&#39;</span>][<span class="stringliteral">&#39;Hostname&#39;</span>]</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        new_name = result_new_container[<span class="stringliteral">&#39;Name&#39;</span>]</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        new_exposed_ports = result_new_container[<span class="stringliteral">&#39;Config&#39;</span>][<span class="stringliteral">&#39;ExposedPorts&#39;</span>]</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        app.logger.info(<span class="stringliteral">&#39;New container with hostname {0} and name {1} exposed ports {2} created&#39;</span>.format(new_hostname,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                                                                                        new_name,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                                                                                        new_exposed_ports))</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        app.logger.info(<span class="stringliteral">&#39;New container created with id {0}&#39;</span>.format(name_id))</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">return</span> result_new_container</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">except</span>:</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">#this will delete the table raw where added port and name in ContainerNames</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            ContainerNames.query.filter_by(public_port=my_unique_port).delete()</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            db.session.commit()</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            app.logger.error(<span class="stringliteral">&#39;An error occurred creating the container&#39;</span>)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">raise</span> <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(<span class="stringliteral">&#39;can\&#39;t make this container&#39;</span>, status_code=404)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a5c4e8ad5904fc41dc6e53312834445ae">  242</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a5c4e8ad5904fc41dc6e53312834445ae">storage_sum</a>():</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="stringliteral">    function to check storage</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    sql_storage_sum = db.engine.execute(text(<span class="stringliteral">&#39;select sum(size_plan) from mount&#39;</span>))</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    storage_sum = []</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">for</span> row <span class="keywordflow">in</span> sql_storage_sum:</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            storage_sum.append(row[0])</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span> storage_sum</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;@app.route (<span class="stringliteral">&#39;/api/seedboxes/storage&#39;</span>, methods=[<span class="stringliteral">&#39;GET&#39;</span>])</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;@require_appkey</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a2d2a47f5b69859690e7d948cbe5898a4">  255</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a2d2a47f5b69859690e7d948cbe5898a4">storage</a>():</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="stringliteral">    curl -i -H &quot;secretkey:1234&quot; http://localhost:5000/api/seedboxes/storage</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="stringliteral">    retunr alocated storage from db</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    dat = <span class="stringliteral">&quot;&#39;disk_space_allocated&#39;: &#39;{0}&#39;&quot;</span>.format(<a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a5c4e8ad5904fc41dc6e53312834445ae">storage_sum</a>())</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    resp = Response(response=dat, status=200, mimetype=<span class="stringliteral">&quot;application/json&quot;</span>)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span> resp</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;@app.route(<span class="stringliteral">&#39;/api/seedboxes/stats/&lt;string:container_id&gt;&#39;</span>, methods=[<span class="stringliteral">&#39;GET&#39;</span>])</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;@require_appkey</div><div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#ae108a533f8a3353f199f69883994c3cf">  268</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#ae108a533f8a3353f199f69883994c3cf">stasts</a>(container_id):</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="stringliteral">    get statistics from container</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="stringliteral">    curl -i -H &#39;secretkey:1234&#39;  http://localhost:5000/api/seedboxes/stats/vm6690_ssh</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="stringliteral">    :param container_id:</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    app.logger.info(<span class="stringliteral">&#39;Received request for container stats for container {0}&#39;</span>.format(container_id))</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        stats_obj = make_connection.connect_docker_server().stats(container_id, decode=<span class="keyword">True</span>, stream=<span class="keyword">False</span>)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span> jsonify(stats_obj)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">except</span>:</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">raise</span> <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(<span class="stringliteral">&#39;There is no container with this name&#39;</span>, status_code=200)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;@app.route(<span class="stringliteral">&#39;/api/seedboxes/management/&lt;string:container_id&gt;&#39;</span>, methods=[<span class="stringliteral">&#39;POST&#39;</span>])</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;@require_appkey</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a96423469e4fe05cd336a8af7cb28d2ba">  285</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a96423469e4fe05cd336a8af7cb28d2ba">management</a>(container_id):</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="stringliteral">    this function will restart/stop/kill an instace</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="stringliteral">    curl -i -H &#39;secretkey:1234&#39; -H &quot;Content-Type: application/json&quot; -X POST -d</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="stringliteral">    &#39;{&quot;action&quot;:&quot;start&quot; }&#39; http://localhost:5000/api/seedboxes/management/b90ea5517564</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="stringliteral">    :param container_id:</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="stringliteral">    :param timeout:</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    content = request.json</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    app.logger.info(<span class="stringliteral">&#39;Do action {0} for container{1}&#39;</span>.format(content[<span class="stringliteral">&#39;action&#39;</span>], container_id))</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">#stop container</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> content[<span class="stringliteral">&#39;action&#39;</span>] == <span class="stringliteral">&#39;stop&#39;</span>:</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        make_connection.connect_docker_server().stop(container_id, timeout=10)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">#restart container</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> content[<span class="stringliteral">&#39;action&#39;</span>] == <span class="stringliteral">&#39;restart&#39;</span>:</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        make_connection.connect_docker_server().restart(container_id, timeout=10)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">#start container after stop</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> content[<span class="stringliteral">&#39;action&#39;</span>] == <span class="stringliteral">&#39;start&#39;</span>:</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        make_connection.connect_docker_server().start(container_id)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">#kill container, main process</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> content[<span class="stringliteral">&#39;action&#39;</span>] == <span class="stringliteral">&#39;kill&#39;</span>:</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        make_connection.connect_docker_server().kill(container_id, timeout=10)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">#delete container, force</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> content[<span class="stringliteral">&#39;action&#39;</span>] == <span class="stringliteral">&#39;delete&#39;</span>:</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        make_connection.connect_docker_server().remove_container(container_id, force=<span class="keyword">True</span>)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keyword">assert</span> isinstance(ContainerNames.query.filter_by(name_of_container=container_id).delete, object)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        ContainerNames.query.filter_by(name_of_container=container_id).delete()</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        db.session.commit()</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    dat = <span class="stringliteral">&quot;{0}&#39;container_id&#39;: &#39;{1}&#39;, &#39;action&#39;: &#39;{2}&#39;{3}&quot;</span>.format(<span class="stringliteral">&#39;{&#39;</span>, container_id, content[<span class="stringliteral">&#39;action&#39;</span>], <span class="stringliteral">&#39;}&#39;</span>)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    resp = Response(response=dat, status=200, mimetype=<span class="stringliteral">&quot;application/json&quot;</span>)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">return</span> resp</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;@app.route(<span class="stringliteral">&#39;/api/seedboxes/execute/&lt;string:name_id&gt;&#39;</span>, methods=[<span class="stringliteral">&#39;POST&#39;</span>])</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;@require_appkey</div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#abf1a0936dc4dd14a5aaa78854c6583ce">  321</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#abf1a0936dc4dd14a5aaa78854c6583ce">executecommands</a>(name_id):</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="stringliteral">    this function will execute commands on the container</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="stringliteral">    curl -i -H &quot;secretkey:1234&quot; -H &quot;Content-Type: application/json&quot; -X POST -d</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="stringliteral">    &#39;{&quot;command&quot;:&quot;htpasswd -b -c /etc/nginx/.htpasswd test test&quot;}&#39; http://arisvm:5000/api/seedboxes/execute/rtorrent</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="stringliteral">    :param name_id:</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        content = request.json</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        app.logger.info(<span class="stringliteral">&#39;executing command:{0} for container:{1}&#39;</span>.format(content[<span class="stringliteral">&#39;command&#39;</span>], name_id))</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        exec_command = make_connection.connect_docker_server().exec_create(name_id, content[<span class="stringliteral">&#39;command&#39;</span>], tty=<span class="keyword">False</span>, stderr=<span class="keyword">True</span>)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        make_connection.connect_docker_server().exec_start(exec_command)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        exec_inspect = make_connection.connect_docker_server().exec_inspect(exec_command)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">return</span> jsonify(exec_inspect)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">except</span>:</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         <span class="keywordflow">raise</span> <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(<span class="stringliteral">&#39;can\&#39;t execute command on non existing/not running container&#39;</span>, status_code=404)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;@app.route(<span class="stringliteral">&#39;/api/seedboxes/new/&lt;string:name_id&gt;&#39;</span>, methods=[<span class="stringliteral">&#39;POST&#39;</span>])</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;@require_appkey</div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#aaab4affe92f8974338caa10c0cf70c22">  343</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#aaab4affe92f8974338caa10c0cf70c22">makevm</a>(name_id):</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="stringliteral">    curl -i -H &quot;secretkey:1234&quot; -H &quot;Content-Type: application/json&quot; -X POST -d &#39;{&quot;username&quot;:&quot;dan&quot;,&quot;password&quot;:</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="stringliteral">    &quot;123456789&quot;, &quot;options&quot;: {&quot;diskspace&quot;:&quot;500m&quot;,&quot;service&quot;:&quot;ssh&quot;}}&#39; http://localhost:5000/api/seedboxes/new/sshdan</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="stringliteral">    this will create a container</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="stringliteral">    we parse the json data and take username/password and we insert this into db</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="stringliteral">    :param name_id:</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    content = request.json</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    app.logger.info(<span class="stringliteral">&#39;Username {0}, passwd:{1}, diskspace:{2}, service:{3}&#39;</span>.format(content[<span class="stringliteral">&#39;username&#39;</span>],</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                                                                  content[<span class="stringliteral">&#39;password&#39;</span>],</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                                                                  content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;diskspace&#39;</span>],</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                                                                  content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;service&#39;</span>]))</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">#check if the hostname is valid, should not contain strange stuff</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> validatehostname.isvalidhostname(name_id):</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">raise</span> <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(<span class="stringliteral">&#39;invalid hostname&#39;</span>, status_code=404)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment"># TODO convert this to dictionary or invet something smarter than if else</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">#create ssh container</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;service&#39;</span>] == <span class="stringliteral">&#39;ssh&#39;</span>:</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        image_name = parser.config_params(<span class="stringliteral">&#39;images&#39;</span>)[<span class="stringliteral">&#39;ssh_image_name&#39;</span>]</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        exec_this = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        internal_port = parser.config_params(<span class="stringliteral">&#39;images&#39;</span>)[<span class="stringliteral">&#39;ssh_internal_port&#39;</span>]</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        new_container = <a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a7c16c9ad1dd493bd800fb0ccb04cfe32">docker_create</a>(name_id, content[<span class="stringliteral">&#39;username&#39;</span>], content[<span class="stringliteral">&#39;password&#39;</span>], content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;service&#39;</span>],</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                      content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;diskspace&#39;</span>], image_name, internal_port, exec_this)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">return</span> jsonify(new_container)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">#create web container</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;service&#39;</span>] == <span class="stringliteral">&#39;web&#39;</span>:</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        image_name = parser.config_params(<span class="stringliteral">&#39;images&#39;</span>)[<span class="stringliteral">&#39;web_image_name&#39;</span>]</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        exec_this = <span class="stringliteral">&#39;python app.py&#39;</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        internal_port = parser.config_params(<span class="stringliteral">&#39;images&#39;</span>)[<span class="stringliteral">&#39;web_internal_port&#39;</span>]</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        new_container = <a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a7c16c9ad1dd493bd800fb0ccb04cfe32">docker_create</a>(name_id, content[<span class="stringliteral">&#39;username&#39;</span>], content[<span class="stringliteral">&#39;password&#39;</span>], content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;service&#39;</span>],</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                      content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;diskspace&#39;</span>], image_name, internal_port, exec_this)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">return</span> jsonify(new_container)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">#create rtorrent container</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;service&#39;</span>] == <span class="stringliteral">&#39;rtorrent&#39;</span>:</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        image_name = parser.config_params(<span class="stringliteral">&#39;images&#39;</span>)[<span class="stringliteral">&#39;rtorrent_image_name&#39;</span>]</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        exec_this = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        internal_port = parser.config_params(<span class="stringliteral">&#39;images&#39;</span>)[<span class="stringliteral">&#39;rtorrent_internal_port&#39;</span>]</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        new_container = <a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a7c16c9ad1dd493bd800fb0ccb04cfe32">docker_create</a>(name_id, content[<span class="stringliteral">&#39;username&#39;</span>], content[<span class="stringliteral">&#39;password&#39;</span>], content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;service&#39;</span>],</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                      content[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;diskspace&#39;</span>], image_name, internal_port, exec_this)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">return</span> jsonify(new_container)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;@app.route(<span class="stringliteral">&#39;/version&#39;</span>, methods=[<span class="stringliteral">&#39;GET&#39;</span>])</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;@require_appkey</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#ad3276ec211f2fe107e03e4ed5e346df6">  395</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#ad3276ec211f2fe107e03e4ed5e346df6">version</a>():</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="stringliteral">    return versios of docker, used for whatever</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">if</span> request.method == <span class="stringliteral">&#39;GET&#39;</span>:</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            my_docker_is = make_connection.connect.version()</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">return</span> render_template(<span class="stringliteral">&#39;version.html&#39;</span>, my_docker_is=my_docker_is)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">except</span>:</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">raise</span> <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(<span class="stringliteral">&#39;Issues with the server&#39;</span>, status_code=503)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;@app.route(<span class="stringliteral">&#39;/api/seedboxes/query/&lt;string:name&gt;&#39;</span>, methods=[<span class="stringliteral">&#39;GET&#39;</span>])</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;@require_appkey</div><div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a7f6173c933a3e2e679eedb795386a08e">  410</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a7f6173c933a3e2e679eedb795386a08e">query</a>(name):</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="stringliteral">    look in the containers db and return values</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="stringliteral">    curl -i -H &#39;secretkey:1234&#39;  http://localhost:5000/api/seedboxes/query/nginx</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        result_search = make_connection.connect.search(name)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">return</span> Response(json.dumps(result_search[:2]), mimetype=<span class="stringliteral">&#39;application/json&#39;</span>)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">except</span>:</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">raise</span> <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(<span class="stringliteral">&#39;Issues with the server&#39;</span>, status_code=503)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"># this will investigate a existing container</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;@app.route(<span class="stringliteral">&#39;/api/seedboxes/investigate/&lt;string:container_id&gt;&#39;</span>, methods=[<span class="stringliteral">&#39;GET&#39;</span>])</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;@require_appkey</div><div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a51d957f776d16e54de05b7034b113c1f">  426</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a51d957f776d16e54de05b7034b113c1f">investigate</a>(container_id):</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="stringliteral">    investigare container, can be name or id</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="stringliteral">    curl -H &#39;secretkey:1234&#39; http://localhost:5000/api/seedboxes/investigate/83f1ee418bc4975c1a76bbffb96fb914caeb13c0cea5d44010e3</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        result_investigate = make_connection.connect.inspect_container(container_id)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keyword">assert</span> isinstance(result_investigate, object)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        app.logger.info(<span class="stringliteral">&#39;Received request for investigate for container {0}&#39;</span>.format(container_id))</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">return</span> jsonify(result_investigate)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">except</span>:</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">raise</span> <a class="code" href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">InvalidUsage</a>(<span class="stringliteral">&#39;There is no such container&#39;</span>, status_code=200)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;@app.route(<span class="stringliteral">&#39;/api/seedboxes/showinstances&#39;</span>, methods=[<span class="stringliteral">&#39;GET&#39;</span>])</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;@require_appkey</div><div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a84a1e1b9285c530fcd8b04177d08cdb3">  443</a></span>&#160;<span class="keyword">def </span><a class="code" href="namespacedocker-proxy_1_1my__proxy.html#a84a1e1b9285c530fcd8b04177d08cdb3">showstuff</a>():</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="stringliteral">    this will return all instances of a specific user</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="stringliteral">    curl -H &#39;secretkey:1234&#39; http://localhost:5000/api/seedboxes/showinstances?name_id=dan</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="stringliteral">    :return:</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> <span class="stringliteral">&#39;name_id&#39;</span> <span class="keywordflow">in</span> request.args:</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        show_property_of_user = request.args[<span class="stringliteral">&#39;name_id&#39;</span>]</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> render_template_string(<span class="stringliteral">&#39;{{what}}&#39;</span>,</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                      what=db.session.query(ContainerNames).filter_by(</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                          name_of_user=show_property_of_user).all())</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">return</span> render_template_string(<span class="stringliteral">&#39;{{what}}&#39;</span>, what=<span class="stringliteral">&#39;need a name&#39;</span>)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">if</span> __name__ == <span class="stringliteral">&#39;__main__&#39;</span>:</div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="namespacedocker-proxy_1_1my__proxy.html#a4cb4fb47e79c0c24a5b66136731a0b0c">  459</a></span>&#160;    app.run(debug=<span class="keyword">True</span>)</div><div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a5c4e8ad5904fc41dc6e53312834445ae"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a5c4e8ad5904fc41dc6e53312834445ae">docker-proxy.my_proxy.storage_sum</a></div><div class="ttdeci">def storage_sum()</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00242">my_proxy.py:242</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html_ac067fae0674728a7064586300ef6b107"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#ac067fae0674728a7064586300ef6b107">docker-proxy.my_proxy.ContainerNames.service_name</a></div><div class="ttdeci">service_name</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00113">my_proxy.py:113</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a219b29b5c79ad35297fb1f1deef275a3"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a219b29b5c79ad35297fb1f1deef275a3">docker-proxy.my_proxy.require_appkey</a></div><div class="ttdeci">def require_appkey(view_function)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00054">my_proxy.py:54</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_invalid_usage_html_aa785dfd5e9946eb87e2a94d4544bc656"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa785dfd5e9946eb87e2a94d4544bc656">docker-proxy.my_proxy.InvalidUsage.__init__</a></div><div class="ttdeci">def __init__(self, message, status_code=None, payload=None)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00034">my_proxy.py:34</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_ad3276ec211f2fe107e03e4ed5e346df6"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#ad3276ec211f2fe107e03e4ed5e346df6">docker-proxy.my_proxy.version</a></div><div class="ttdeci">def version()</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00395">my_proxy.py:395</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a32ea0c997fb4530822b84a6861f9666c"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a32ea0c997fb4530822b84a6861f9666c">docker-proxy.my_proxy.give_me_mount_point</a></div><div class="ttdeci">def give_me_mount_point(owner, size_plan)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00167">my_proxy.py:167</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_mount_points_html_aec1c878c659bd308f99b529d397d85c7"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aec1c878c659bd308f99b529d397d85c7">docker-proxy.my_proxy.MountPoints.volume_name</a></div><div class="ttdeci">volume_name</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00081">my_proxy.py:81</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_invalid_usage_html_a50b7849f7141fc1455ace3691a9417a7"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#a50b7849f7141fc1455ace3691a9417a7">docker-proxy.my_proxy.InvalidUsage.to_dict</a></div><div class="ttdeci">def to_dict(self)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00041">my_proxy.py:41</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a51d957f776d16e54de05b7034b113c1f"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a51d957f776d16e54de05b7034b113c1f">docker-proxy.my_proxy.investigate</a></div><div class="ttdeci">def investigate(container_id)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00426">my_proxy.py:426</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_ae108a533f8a3353f199f69883994c3cf"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#ae108a533f8a3353f199f69883994c3cf">docker-proxy.my_proxy.stasts</a></div><div class="ttdeci">def stasts(container_id)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00268">my_proxy.py:268</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html">docker-proxy.my_proxy.ContainerNames</a></div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00096">my_proxy.py:96</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_mount_points_html_aa49cde7530c0edaec96a4407707e714d"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aa49cde7530c0edaec96a4407707e714d">docker-proxy.my_proxy.MountPoints.owner</a></div><div class="ttdeci">owner</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00079">my_proxy.py:79</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_mount_points_html_a6008b3f58ac2dd027f1d637cc84ee78c"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#a6008b3f58ac2dd027f1d637cc84ee78c">docker-proxy.my_proxy.MountPoints.size_plan</a></div><div class="ttdeci">size_plan</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00082">my_proxy.py:82</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html_a5223d4e116bb162d327af3fbdf406c62"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5223d4e116bb162d327af3fbdf406c62">docker-proxy.my_proxy.ContainerNames.name_of_container</a></div><div class="ttdeci">name_of_container</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00103">my_proxy.py:103</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a2d2a47f5b69859690e7d948cbe5898a4"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a2d2a47f5b69859690e7d948cbe5898a4">docker-proxy.my_proxy.storage</a></div><div class="ttdeci">def storage()</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00255">my_proxy.py:255</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_mount_points_html_a559b6a122b5406dda695f40dc5eda8e9"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#a559b6a122b5406dda695f40dc5eda8e9">docker-proxy.my_proxy.MountPoints.__init__</a></div><div class="ttdeci">def __init__(self, owner, mount_point, volume_name, size_plan)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00084">my_proxy.py:84</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_invalid_usage_html_aa06f3c7722ee51c93e799a0e57f67a32"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa06f3c7722ee51c93e799a0e57f67a32">docker-proxy.my_proxy.InvalidUsage.status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00032">my_proxy.py:32</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html_accfbd6e258c7ede9ac75360c54086e2a"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#accfbd6e258c7ede9ac75360c54086e2a">docker-proxy.my_proxy.ContainerNames.public_port</a></div><div class="ttdeci">public_port</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00111">my_proxy.py:111</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_aaab4affe92f8974338caa10c0cf70c22"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#aaab4affe92f8974338caa10c0cf70c22">docker-proxy.my_proxy.makevm</a></div><div class="ttdeci">def makevm(name_id)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00343">my_proxy.py:343</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_mount_points_html_aea56d9596b2864b4d089b0f34744f3f4"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aea56d9596b2864b4d089b0f34744f3f4">docker-proxy.my_proxy.MountPoints.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00090">my_proxy.py:90</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a0bf8985afda99ee825115bd5df0b6b40"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a0bf8985afda99ee825115bd5df0b6b40">docker-proxy.my_proxy.give_me_something_unique</a></div><div class="ttdeci">def give_me_something_unique(name_of_container, hostname, owner, password, service_name)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00134">my_proxy.py:134</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_invalid_usage_html_aa61d504376bb9479db82cb7d97c70011"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#aa61d504376bb9479db82cb7d97c70011">docker-proxy.my_proxy.InvalidUsage.message</a></div><div class="ttdeci">message</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00036">my_proxy.py:36</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a7f6173c933a3e2e679eedb795386a08e"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a7f6173c933a3e2e679eedb795386a08e">docker-proxy.my_proxy.query</a></div><div class="ttdeci">def query(name)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00410">my_proxy.py:410</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_mount_points_html_aa7cfbe6eb066a60a4b6a0399fc64e003"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html#aa7cfbe6eb066a60a4b6a0399fc64e003">docker-proxy.my_proxy.MountPoints.mount_point</a></div><div class="ttdeci">mount_point</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00080">my_proxy.py:80</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_abf1a0936dc4dd14a5aaa78854c6583ce"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#abf1a0936dc4dd14a5aaa78854c6583ce">docker-proxy.my_proxy.executecommands</a></div><div class="ttdeci">def executecommands(name_id)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00321">my_proxy.py:321</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html_aacca73fd2984a6225ff6f82fb681a508"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#aacca73fd2984a6225ff6f82fb681a508">docker-proxy.my_proxy.ContainerNames.hostname</a></div><div class="ttdeci">hostname</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00105">my_proxy.py:105</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_invalid_usage_html"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html">docker-proxy.my_proxy.InvalidUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00028">my_proxy.py:28</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_invalid_usage_html_a658b9343c56fde3e1753fe8ad1e1a158"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_invalid_usage.html#a658b9343c56fde3e1753fe8ad1e1a158">docker-proxy.my_proxy.InvalidUsage.payload</a></div><div class="ttdeci">payload</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00039">my_proxy.py:39</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html_a6f793b87c5c96d4c3c8becfbc748ada9"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a6f793b87c5c96d4c3c8becfbc748ada9">docker-proxy.my_proxy.ContainerNames.__init__</a></div><div class="ttdeci">def __init__(self, name_of_container, hostname, owner, password, public_port, service_name)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00115">my_proxy.py:115</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a0c927506d8346f17b620ac8e131174d0"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a0c927506d8346f17b620ac8e131174d0">docker-proxy.my_proxy.handle_invalid_usage</a></div><div class="ttdeci">def handle_invalid_usage(error)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00048">my_proxy.py:48</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a7c16c9ad1dd493bd800fb0ccb04cfe32"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a7c16c9ad1dd493bd800fb0ccb04cfe32">docker-proxy.my_proxy.docker_create</a></div><div class="ttdeci">def docker_create(name_id, username, password, service, diskspace, image_name, internal_port, exec_this)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00195">my_proxy.py:195</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a96423469e4fe05cd336a8af7cb28d2ba"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a96423469e4fe05cd336a8af7cb28d2ba">docker-proxy.my_proxy.management</a></div><div class="ttdeci">def management(container_id)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00285">my_proxy.py:285</a></div></div>
<div class="ttc" id="namespacedocker-proxy_1_1my__proxy_html_a84a1e1b9285c530fcd8b04177d08cdb3"><div class="ttname"><a href="namespacedocker-proxy_1_1my__proxy.html#a84a1e1b9285c530fcd8b04177d08cdb3">docker-proxy.my_proxy.showstuff</a></div><div class="ttdeci">def showstuff()</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00443">my_proxy.py:443</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html_a18b80021fc434e7dac00f009f7a451b5"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a18b80021fc434e7dac00f009f7a451b5">docker-proxy.my_proxy.ContainerNames.owner</a></div><div class="ttdeci">owner</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00107">my_proxy.py:107</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html_a5bade0263a94bbfc7ffba0b4179ae27e"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5bade0263a94bbfc7ffba0b4179ae27e">docker-proxy.my_proxy.ContainerNames.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00124">my_proxy.py:124</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_mount_points_html"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_mount_points.html">docker-proxy.my_proxy.MountPoints</a></div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00073">my_proxy.py:73</a></div></div>
<div class="ttc" id="classdocker-proxy_1_1my__proxy_1_1_container_names_html_a5728904cb244540aa3421e07dc14cc84"><div class="ttname"><a href="classdocker-proxy_1_1my__proxy_1_1_container_names.html#a5728904cb244540aa3421e07dc14cc84">docker-proxy.my_proxy.ContainerNames.password</a></div><div class="ttdeci">password</div><div class="ttdef"><b>Definition:</b> <a href="my__proxy_8py_source.html#l00109">my_proxy.py:109</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="my__proxy_8py.html">my_proxy.py</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
